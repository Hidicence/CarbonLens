# 🔄 CarbonLens 數據同步測試指南

## ✅ 當前服務狀態

### 🎯 所有服務已啟動並運行正常！

| 服務 | 端口 | 狀態 | 訪問地址 |
|------|------|------|----------|
| 後端API | 3001 | ✅ 運行中 | http://localhost:3001 |
| Web前端 | 3000 | ✅ 運行中 | http://localhost:3000 |
| 測試工具 | 8090 | ✅ 運行中 | http://localhost:8090/test |
| APP開發服務器 | 8081-8084 | ✅ 運行中 | 掃描QR碼連接 |

## 🚀 開始測試數據同步

### 第一步：測試API功能
1. 訪問測試工具：**http://localhost:8090/test**
2. 點擊「檢查所有服務」確認狀態
3. 點擊「測試API連接」驗證後端
4. 點擊「創建測試專案」
5. 點擊「創建排放記錄」
6. 點擊「創建營運記錄」

### 第二步：Web端驗證
1. 訪問Web前端：**http://localhost:3000**
2. 檢查是否能看到剛才創建的測試數據
3. 在Web界面創建新的專案和記錄

### 第三步：APP端同步測試
1. 打開CarbonLens APP
2. 查看右上角的同步狀態指示器
3. 手動觸發同步（如果需要）
4. 驗證Web端創建的數據是否出現在APP中

### 第四步：雙向同步驗證
1. 在APP中創建新的專案和記錄
2. 等待自動同步（15分鐘）或手動觸發同步
3. 回到Web界面刷新頁面
4. 檢查APP創建的數據是否出現在Web中

## 🔍 同步狀態監控

### 在測試工具中監控
- 訪問：http://localhost:8090/test
- 點擊「開始監控」實時查看API狀態
- 每5秒自動檢查一次數據變化

### 在APP中查看同步狀態
- 🟢 綠色圓點：同步成功
- 🟡 黃色圓點：同步中
- 🔴 紅色圓點：同步失敗
- 顯示最後同步時間和進度

## 📊 測試數據示例

### 專案數據
```json
{
  "name": "測試同步專案",
  "description": "用於測試數據同步的專案",
  "status": "active",
  "startDate": "2025-06-17",
  "location": "台北市"
}
```

### 排放記錄數據
```json
{
  "projectId": "project-id",
  "description": "測試排放記錄",
  "category": "transport",
  "stage": "production",
  "amount": 100.5,
  "date": "2025-06-17",
  "location": "測試地點"
}
```

### 營運記錄數據
```json
{
  "description": "測試營運記錄",
  "category": "electricity",
  "amount": 50.25,
  "date": "2025-06-17"
}
```

## 🎉 成功標準

數據同步成功的表現：
- ✅ Web端創建的數據出現在APP中
- ✅ APP端創建的數據出現在Web中
- ✅ 數據內容完全一致
- ✅ 同步狀態指示器顯示正常
- ✅ 沒有錯誤信息

## 🐛 問題排除

### CORS錯誤
- ✅ 已解決：後端已配置允許跨域請求
- ✅ 已解決：使用HTTP服務器而非file://協議

### 端口衝突
- ✅ 已解決：測試服務器使用端口8090
- ✅ 已解決：自動檢測可用端口

### 服務未啟動
1. 檢查端口是否被占用
2. 重新啟動對應服務
3. 查看錯誤日誌

## 📞 快速訪問鏈接

- 🧪 **測試工具首頁**: http://localhost:8090/test
- 🌐 **Web前端**: http://localhost:3000
- 📡 **API健康檢查**: http://localhost:3001/health
- 📋 **測試指南**: http://localhost:8090/guide

## 🔄 重啟服務

如果需要重啟服務：

```bash
# 重啟後端
cd backend
npm run build
npm start

# 重啟Web前端
cd web-frontend
npm run dev

# 重啟測試服務器
node simple-server.js
```

## 📝 測試記錄

請在測試過程中記錄：
- [ ] API連接測試 - 通過/失敗
- [ ] 專案創建測試 - 通過/失敗
- [ ] 排放記錄同步 - 通過/失敗
- [ ] 營運記錄同步 - 通過/失敗
- [ ] Web→APP同步 - 通過/失敗
- [ ] APP→Web同步 - 通過/失敗
- [ ] 衝突解決測試 - 通過/失敗
- [ ] 離線同步測試 - 通過/失敗

---

🎯 **現在您可以開始完整的數據同步測試了！**

從這裡開始：**http://localhost:8090/test** 